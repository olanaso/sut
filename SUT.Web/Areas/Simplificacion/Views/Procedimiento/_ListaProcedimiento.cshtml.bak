@using Sut.Entities;
@model List<Procedimiento>
@{ Sut.Security.UsuarioInfo user = ViewBag.Usuario as Sut.Security.UsuarioInfo;
    Sut.Security.UsuarioInfo userInf = ViewBag.UsuarioInf as Sut.Security.UsuarioInfo;
    Sut.Security.UsuarioInfo userDatos = ViewBag.UsuarioDatos as Sut.Security.UsuarioInfo;
    Sut.Security.UsuarioInfo userSTL = ViewBag.UsuarioSTL as Sut.Security.UsuarioInfo;
    Sut.Security.UsuarioInfo userAsme = ViewBag.UsuarioAsme as Sut.Security.UsuarioInfo;
    Sut.Security.UsuarioInfo userrptTupa = ViewBag.UsuariorptTupa as Sut.Security.UsuarioInfo;
    Sut.Security.UsuarioInfo userptSTL = ViewBag.UsuariorptSTL as Sut.Security.UsuarioInfo;

    Sut.Security.UsuarioInfo userCostos = ViewBag.UsuarioCostos as Sut.Security.UsuarioInfo;
    Sut.Security.UsuarioInfo userrptTupaCompleto = ViewBag.UsuariorptTupaCompleto as Sut.Security.UsuarioInfo;
    Sut.Security.UsuarioInfo userrptSTLCompleto = ViewBag.UsuariorptSTLCompleto as Sut.Security.UsuarioInfo;
    Expediente exp = ViewBag.Expediente as Expediente; }
<tbody data-totalrows="@ViewBag.TotalRows">
    @if (Model.Count() > 0)
    {
        int i = (int)ViewBag.Row;
        foreach (Procedimiento p in Model)
        {
            <tr>
                @if (p.Posicion == 1)
                {

                    <td style="text-align: center; color: #000;background: #ccc;">
                        @if (exp.EstadoExpediente == EstadoExpediente.EnProceso || exp.EstadoExpediente == EstadoExpediente.Observado)
                        {
                            <div class="btn-group">
                                @if (p.Operacion == OperacionExpediente.Ninguna || p.Operacion == OperacionExpediente.Eliminacion)
                                {
                                    if (user.rolmenu[0].Editar == true)
                                    {
                                        <a class="btn btn-primary btn-xs" href="javascript:sut.Procedimiento.modificar(@p.ProcedimientoId)" data-placement="bottom" title="Modificar"><i class="fa fa-pencil"></i></a>}
                                }
                            </div>}
                    </td>

                    <td style=" text-align: center; color: #000;background: #ccc;">
                        @if (exp.EstadoExpediente == EstadoExpediente.EnProceso || exp.EstadoExpediente == EstadoExpediente.Observado)
                        {
                            <div class="btn-group">

                                @if (p.Operacion == OperacionExpediente.Ninguna || p.Operacion == OperacionExpediente.Modificacion)
                                {
                                    if (user.rolmenu[0].Eliminar == true)
                                    {
                                        <a class="btn btn-danger btn-xs" href="javascript:sut.Procedimiento.eliminar(@p.ProcedimientoId)" data-placement="bottom" title="Eliminar"><i class="fa fa-remove"></i></a> }
                                }
                                else if (p.Operacion == OperacionExpediente.Nuevo)
                                {
                                    if (user.rolmenu[0].Eliminar == true)
                                    {
                                        <a class="btn btn-danger btn-xs" href="javascript:sut.Procedimiento.eliminarNuevo(@p.ProcedimientoId)" data-placement="bottom" title="Eliminar"><i class="fa fa-remove"></i></a>}
                                }
                            </div>}
                    </td>
                    if (p.Operacion != OperacionExpediente.Eliminacion)
                    {

                        if (exp.EditarNum == "1")
                        {
                            <td style=" width: 50px; text-align: center;color: #000; background: #ccc;">@Html.TextBoxFor(model => p.Numero, new { @class = "form-control" })</td>
                        }
                        else
                        {
                            <td style="width: 50px;text-align: center;color: #000; background: #ccc;">@p.Numero</td>
                        }
                    }
                    else
                    {
                        <td></td>
                    }
                    <td style="width: 150px;text-align: center; color: #000;background: #ccc;">@Html.TipoOperacion(p.Operacion)</td>
                    if (@p.CodigoCorto != null && p.Operacion != OperacionExpediente.Eliminacion)
                    {
                        <td style="color: #000;background: #ccc;">
                            @if (@user.rolmenu[0].Editar == true)
                            {
                                <a class="btn btn-success btn-xs" href="javascript:javascript:sut.Procedimiento.Editarnuevo(@p.ProcedimientoId)"><i class="fa fa-pencil"></i></a>}

                        </td>
                    }
                    else
                    {
                        if (p.Operacion != OperacionExpediente.Eliminacion)
                        {
                            <td style="color: #000;background: #ccc;">
                                @if (@user.rolmenu[0].Editar == true)
                                {
                                    <a class="btn btn-success btn-xs" href="javascript:sut.Procedimiento.verDatosGenerales(@p.ProcedimientoId)"><i class="fa fa-pencil"></i></a>}
                            </td>
                        }
                        else
                        {
                            <td style="color: #000;background: #ccc;"></td>
                        }
                    }

                    <td style="color: #000;background: #ccc;">@p.CodigoCorto</td>
                    <td style="color: #000;background: #ccc;">@p.UndOrgResponsable.Nombre</td>
                    <td style="color: #000;background: #ccc;">@p.Denominacion</td>
                    if (p.CodigoACR == "0")
                    {
                        <td style="color: #000;background: #ccc;">@Html.TipoProcedimiento(p.TipoProcedimiento)</td>
                        //<td style="color: #000;background: #ccc;"><label style="width: 233px;font-size: 100%;font-weight: normal;line-height: 28px;color: #fff !important; padding: 0 15px; border-radius: 10px; display: inline-block;background-color: #1087dd;">@Html.TipoProcedimiento(p.TipoProcedimiento)</label></td>
                    }
                    else
                    {
                        <td style="color: #000;background: #ccc;"><label style="width: 233px;font-size: 100%;font-weight: normal;line-height: 28px;color: #fff !important; padding: 0 15px; border-radius: 10px; display: inline-block;background-color: #1087dd;">PROCEDIMIENTO ADMINISTRATIVO</label></td>
                    }

                    <td style="color: #000;background: #ccc;">
                        @p.NombreCategoria
                    </td>
                    <td class="text-center" style="color: #000;background: #ccc;">
                        @if (p.TipoProcedimiento != TipoProcedimiento.Estandar)
                        {
                            if (exp.EstadoExpediente != EstadoExpediente.Publicado && p.Operacion != OperacionExpediente.Ninguna && exp.EstadoExpediente != EstadoExpediente.Aprobado && exp.EstadoExpediente != EstadoExpediente.Observado && exp.EstadoExpediente != EstadoExpediente.Anulado && p.Operacion != OperacionExpediente.Eliminacion && p.CodigoACR == "0")
                            {
                                if (user.rolmenu[0].Copiar == true)
                                {
                                    <a class="btn btn-default btn-xs" href="javascript:sut.Procedimiento.copiar(@p.ProcedimientoId)"><i class="fa fa-copy"></i></a> }
                            }

                        }
                        else
                        {

                            if (user.Rol == (short)Rol.Administrador && p.Operacion != OperacionExpediente.Ninguna)
                            {
                                if (user.rolmenu[0].Copiar == true)
                                {
                                    <a class="btn btn-default btn-xs" href="javascript:sut.Procedimiento.copiar(@p.ProcedimientoId)"><i class="fa fa-copy"></i></a>}
                            }

                        }

                    </td>
                    <td class="text-center" style="color: #000;background: #ccc;">


                        @if (userInf.rolmenu[0].Ver == true)
                        {
                            if (exp.EstadoExpediente != EstadoExpediente.Anulado)
                            {

                                if (p.Operacion != OperacionExpediente.Ninguna && p.Operacion != OperacionExpediente.Eliminacion)
                                {
                                    if (p.InfCdnoTerminado)
                                    {
                                        <a href="javascript:sut.Procedimiento.verNotasCiudadano(@p.ProcedimientoId)">@Html.TipoEstadoOpciones2(p.EstadoInfo)</a> }
                                    else
                                    {
                                        if (exp.EstadoExpediente == EstadoExpediente.Aprobado && user.TipoTupa == (short)TipoTupa.Estandar)
                                        {
                                            <a href="javascript:sut.Procedimiento.verNotasCiudadano(@p.ProcedimientoId)">@Html.TipoEstadoOpciones2(p.EstadoInfo)</a> }
                                        else
                                        {

                                            <a href="javascript:sut.Procedimiento.verNotasCiudadano(@p.ProcedimientoId)">@Html.TipoEstadoOpciones2(p.EstadoInfo)</a> }
                                    }
                                }
                                else if (p.Operacion == OperacionExpediente.Ninguna || p.Operacion == OperacionExpediente.Eliminacion)
                                {
                                    <a class="btn btn-primary btn-xs" href="javascript:sut.Procedimiento.verNotasCiudadano(@p.ProcedimientoId)"><i class="fa fa-search"></i></a> }
                            }
                            else
                            {
                                <a class="btn btn-primary btn-xs" href="javascript:sut.Procedimiento.verNotasCiudadano(@p.ProcedimientoId)"><i class="fa fa-search"></i></a> } @*<a class="btn btn-success btn-xs" href="javascript:sut.Procedimiento.verNotasCiudadano(@p.ProcedimientoId)"><i class="fa fa-pencil"></i></a>*@}

                    </td>
                    <td class="text-center" style="color: #000;background: #ccc;">
                        @if (userDatos.rolmenu[0].Ver == true)
                        {
                            if (exp.EstadoExpediente != EstadoExpediente.Anulado)
                            {

                                if (p.Operacion != OperacionExpediente.Ninguna && p.Operacion != OperacionExpediente.Eliminacion)
                                {
                                    if (p.DatosGeneralesTerminado)
                                    {
                                        <a href="javascript:sut.Procedimiento.verDatosGenerales(@p.ProcedimientoId)">@Html.TipoEstadoOpciones2(p.Estadodatos)</a> }
                                    else
                                    {
                                        if (exp.EstadoExpediente == EstadoExpediente.Aprobado && user.TipoTupa == (short)TipoTupa.Estandar)
                                        {
                                            <a href="javascript:sut.Procedimiento.verDatosGenerales(@p.ProcedimientoId)">@Html.TipoEstadoOpciones2(p.Estadodatos)</a> }
                                        else
                                        {

                                            <a href="javascript:sut.Procedimiento.verDatosGenerales(@p.ProcedimientoId)">@Html.TipoEstadoOpciones2(p.Estadodatos)</a> }
                                    }
                                }
                                else if (p.Operacion == OperacionExpediente.Ninguna || p.Operacion == OperacionExpediente.Eliminacion)
                                {
                                    <a class="btn btn-primary btn-xs" href="javascript:sut.Procedimiento.verDatosGenerales(@p.ProcedimientoId)"><i class="fa fa-search"></i></a> }
                            }
                            else
                            {
                                <a class="btn btn-primary btn-xs" href="javascript:sut.Procedimiento.verDatosGenerales(@p.ProcedimientoId)"><i class="fa fa-search"></i></a>}

                        }
                    </td>
                    if (exp.TipoExpediente != TipoExpediente.CargaInicial)
                    {
                        <td class="text-center" style="color: #000;background: #ccc;">
                            @if (userSTL.rolmenu[0].Ver == true)
                            {
                                if (exp.EstadoExpediente != EstadoExpediente.Anulado)
                                {

                                    if (user.TipoTupa != (short)TipoTupa.Estandar && p.Operacion != OperacionExpediente.Ninguna)
                                    {
                                        if (p.TipoProcedimiento != TipoProcedimiento.Estandar)
                                        {
                                            if (p.Operacion != OperacionExpediente.Ninguna && p.Operacion != OperacionExpediente.Eliminacion)
                                            {
                                                if (p.SustTecnicoTerminado)
                                                {
                                                    <a href="javascript:sut.Procedimiento.verSustentoTecnico(@p.ProcedimientoId)">@Html.TipoEstadoOpciones2(p.Estadostl)</a> }
                                                else
                                                {
                                                    <a href="javascript:sut.Procedimiento.verSustentoTecnico(@p.ProcedimientoId)">@Html.TipoEstadoOpciones2(p.Estadostl)</a> }
                                            }
                                            else if (p.Operacion == OperacionExpediente.Ninguna || p.Operacion == OperacionExpediente.Eliminacion)
                                            {
                                                <a class="btn btn-primary btn-xs" href="javascript:sut.Procedimiento.verSustentoTecnico(@p.ProcedimientoId)"><i class="fa fa-search"></i></a> }
                                        }
                                        else if (p.SustTecnicoTerminado)
                                        {
                                            <a href="javascript:sut.Procedimiento.verSustentoTecnico(@p.ProcedimientoId)">@Html.TipoEstadoOpciones2(p.Estadostl)</a> }
                                        else if (p.Operacion != OperacionExpediente.Ninguna && p.Operacion != OperacionExpediente.Eliminacion)
                                        {
                                            <a href="javascript:sut.Procedimiento.verSustentoTecnico(@p.ProcedimientoId)">@Html.TipoEstadoOpciones2(p.Estadostl)</a> }


                                    }
                                    else
                                    {
                                        if (p.Operacion != OperacionExpediente.Ninguna && p.Operacion != OperacionExpediente.Eliminacion)
                                        {
                                            if (p.SustTecnicoTerminado)
                                            {
                                                <a href="javascript:sut.Procedimiento.verSustentoTecnico(@p.ProcedimientoId)">@Html.TipoEstadoOpciones2(p.Estadostl)</a> }
                                            else
                                            {

                                                if (exp.EstadoExpediente == EstadoExpediente.Aprobado && user.TipoTupa == (short)TipoTupa.Estandar)
                                                {
                                                    <a href="javascript:sut.Procedimiento.verSustentoTecnico(@p.ProcedimientoId)">@Html.TipoEstadoOpciones2(p.Estadostl)</a> }
                                                else
                                                {

                                                    <a href="javascript:sut.Procedimiento.verSustentoTecnico(@p.ProcedimientoId)">@Html.TipoEstadoOpciones2(p.Estadostl)</a> }
                                            }
                                        }
                                        else if (p.Operacion == OperacionExpediente.Ninguna || p.Operacion == OperacionExpediente.Eliminacion)
                                        {
                                            <a class="btn btn-primary btn-xs" href="javascript:sut.Procedimiento.verSustentoTecnico(@p.ProcedimientoId)"><i class="fa fa-search"></i></a> }
                                    }
                                }
                                else
                                { <a class="btn btn-primary btn-xs" href="javascript:sut.Procedimiento.verSustentoTecnico(@p.ProcedimientoId)"><i class="fa fa-search"></i></a>}

                            }
                        </td>
                    }


                    if (exp.TipoExpediente != TipoExpediente.CargaInicial)
                    {
                        <td class="text-center" style="color: #000;background: #ccc;">
                            @if (userAsme.rolmenu[0].Ver == true)
                            {
                                {
                                    if (exp.EstadoExpediente != EstadoExpediente.Anulado)
                                    {
                                        if (p.Operacion != OperacionExpediente.Ninguna && p.Operacion != OperacionExpediente.Eliminacion)
                                        {
                                            if (!p.TablaAsmeTerminado)
                                            {
                                                if (exp.EstadoExpediente == EstadoExpediente.Aprobado && user.TipoTupa == (short)TipoTupa.Estandar)
                                                {
                                                    <a href="javascript:sut.Procedimiento.verTablaAsme(@p.ProcedimientoId)">@Html.TipoEstadoOpciones2(p.Estadotablaasme)</a> }
                                                else
                                                {

                                                    <a href="javascript:sut.Procedimiento.verTablaAsme(@p.ProcedimientoId)">@Html.TipoEstadoOpciones2(p.Estadotablaasme)</a> }

                                            }
                                            else
                                            {
                                                <a href="javascript:sut.Procedimiento.verTablaAsme(@p.ProcedimientoId)">@Html.TipoEstadoOpciones2(p.Estadotablaasme)</a> }

                                        }
                                        else if (p.Operacion == OperacionExpediente.Ninguna || p.Operacion == OperacionExpediente.Eliminacion)
                                        {
                                            <a class="btn btn-primary btn-xs" href="javascript:sut.Procedimiento.verTablaAsme(@p.ProcedimientoId)"><i class="fa fa-search"></i></a> }
                                    }
                                    else
                                    {
                                        <a class="btn btn-primary btn-xs" href="javascript:sut.Procedimiento.verTablaAsme(@p.ProcedimientoId)"><i class="fa fa-search"></i></a>}
                                }
                            }
                        </td>
                    }
                    <td style="color: #000;background: #ccc;">
                        @if (userrptTupa.rolmenu[0].Ver == true)
                        {
                            {
                                if (@p.CodigoCorto != null)
                                {@*<a class="btn btn-default btn-xs" href="@Url.Content("~/General/Reporte/ReporteTupa")?ExpedienteId=@p.ExpedienteId&&ProcedimientoId=@p.ProcedimientoId&&orden=1" target="_blank"><i class="fa fa-file-pdf-o"></i></a>*@
                                @*<a class="btn btn-default btn-xs" href="javascript:sut.Procedimiento.ReporteTupa(@p.ExpedienteId,@p.ProcedimientoId,1)"><i class="fa fa-file-pdf-o"></i></a>
                                    JJJMSP2*@
                                <a class="btn btn-default btn-xs"><input name="ReportePAs" type="checkbox" id=@p.ProcedimientoId></a>}
                        }
                    }
                    </td>
                    if (exp.TipoExpediente != TipoExpediente.CargaInicial)
                    {
                        <td style="color: #000;background: #ccc;">
                            @if (userptSTL.rolmenu[0].Ver == true)
                            {
                                if (@p.CodigoCorto != null)
                                {@*<a class="btn btn-default btn-xs" href="@Url.Content("~/General/Reporte/FSLT")?tipo=2&id=@p.ProcedimientoId" target="_blank"><i class="fa fa-file-pdf-o"></i></a>*@
                                @*<a class="btn btn-default btn-xs" href="javascript:sut.Procedimiento.FSLT(2,@p.ProcedimientoId)"><i class="fa fa-file-pdf-o"></i></a>
                                    JJJMSP2 *@
                                <a class="btn btn-default btn-xs"><input name="ReporteFSTLs" type="checkbox" id=@p.ProcedimientoId></a>}
                        }
                        </td>
                    }
                    <td class="text-center" style="color: #000;background: #ccc;">@p.CodigoACR</td>
                }
                else
                {

                    <td style="text-align:center">
                        @if (exp.EstadoExpediente == EstadoExpediente.EnProceso || exp.EstadoExpediente == EstadoExpediente.Observado)
                        {
                            <div class="btn-group">
                                @if (p.Operacion == OperacionExpediente.Ninguna || p.Operacion == OperacionExpediente.Eliminacion)
                                {
                                    if (user.rolmenu[0].Editar == true)
                                    {
                                        <a class="btn btn-primary btn-xs" href="javascript:sut.Procedimiento.modificar(@p.ProcedimientoId)" data-placement="bottom" title="Modificar"><i class="fa fa-pencil"></i></a> }
                                }
                                else if (p.EstadoNinguno == 1)
                                {
                                    if (user.rolmenu[0].Editar == true)
                                    {
                                        <a class="btn btn-primary btn-xs" href="javascript:sut.Procedimiento.modificarNinguno(@p.ProcedimientoId)" data-placement="bottom" title="Restablecer Ninguno"><i class="fa fa-pencil"></i></a>}
                                }
                            </div>}
                    </td>

                    <td style="text-align:center">
                        @if (exp.EstadoExpediente == EstadoExpediente.EnProceso || exp.EstadoExpediente == EstadoExpediente.Observado)
                        {
                            <div class="btn-group">

                                @if (p.Operacion == OperacionExpediente.Ninguna || p.Operacion == OperacionExpediente.Modificacion)
                                {
                                    if (user.rolmenu[0].Eliminar == true)
                                    {
                                        <a class="btn btn-danger btn-xs" href="javascript:sut.Procedimiento.eliminar(@p.ProcedimientoId)" data-placement="bottom" title="Eliminar"><i class="fa fa-remove"></i></a> }
                                }
                                else if (p.Operacion == OperacionExpediente.Nuevo)
                                {
                                    if (user.rolmenu[0].Eliminar == true)
                                    {
                                        <a class="btn btn-danger btn-xs" href="javascript:sut.Procedimiento.eliminarNuevo(@p.ProcedimientoId)" data-placement="bottom" title="Eliminar"><i class="fa fa-remove"></i></a>}
                                }
                            </div>}
                    </td>
                    if (p.Operacion != OperacionExpediente.Eliminacion)
                    {

                        if (exp.EditarNum == "1")
                        {
                            <td style="width:50px;text-align:center">@Html.TextBoxFor(model => p.Numero, new { @class = "form-control" })</td>
                        }
                        else
                        {
                            <td style="width:50px;text-align:center">@p.Numero</td>
                        }
                    }
                    else
                    {
                        <td></td>
                    }
                    <td style="width:150px;text-align:center">@Html.TipoOperacion(p.Operacion)</td>
                    if (@p.CodigoCorto != null && p.Operacion != OperacionExpediente.Eliminacion)
                    {
                        <td>
                            @*@if (exp.EstadoExpediente == EstadoExpediente.EnProceso || exp.EstadoExpediente == EstadoExpediente.Observado)
                                {*@
                            @if (@user.rolmenu[0].Editar == true)
                            {
                                <a class="btn btn-success btn-xs" href="javascript:javascript:sut.Procedimiento.Editarnuevo(@p.ProcedimientoId)"><i class="fa fa-pencil"></i></a> } @*}*@

                        </td>
                    }
                    else
                    {
                        if (p.Operacion != OperacionExpediente.Eliminacion)
                        {
                            <td>
                                @if (@user.rolmenu[0].Editar == true)
                                {
                                    <a class="btn btn-success btn-xs" href="javascript:sut.Procedimiento.verDatosGenerales(@p.ProcedimientoId)"><i class="fa fa-pencil"></i></a>}
                            </td>
                        }
                        else
                        {
                            <td></td>
                        }
                    }

                    <td>@p.CodigoCorto</td>
                    <td>@p.UndOrgResponsable.Nombre</td>
                    <td>@p.Denominacion</td>
                    if (p.CodigoACR == "0")
                    {
                        <td>@Html.TipoProcedimiento(p.TipoProcedimiento)</td>
                        //<td style="color: #000;background: #ccc;"><label style="width: 233px;font-size: 100%;font-weight: normal;line-height: 28px;color: #fff !important; padding: 0 15px; border-radius: 10px; display: inline-block;background-color: #1087dd;">@Html.TipoProcedimiento(p.TipoProcedimiento)</label></td>
                        //<td><label style="width: 233px;font-size: 100%;font-weight: normal;line-height: 28px;color: #fff !important; padding: 0 15px; border-radius: 10px; display: inline-block;background-color: #1087dd;">@Html.TipoProcedimiento(p.TipoProcedimiento)</label></td>
                    }
                    else
                    {
                        <td><label style="width: 233px;font-size: 100%;font-weight: normal;line-height: 28px;color: #fff !important; padding: 0 15px; border-radius: 10px; display: inline-block;background-color: #1087dd;">PROCEDIMIENTO ADMINISTRATIVO</label></td>
                    }

                    <td>
                        @p.NombreCategoria
                    </td>
                    <td class="text-center">
                        @if (p.TipoProcedimiento != TipoProcedimiento.Estandar)
                        {
                            if (exp.EstadoExpediente != EstadoExpediente.Publicado && p.Operacion != OperacionExpediente.Ninguna && exp.EstadoExpediente != EstadoExpediente.Aprobado && exp.EstadoExpediente != EstadoExpediente.Observado && exp.EstadoExpediente != EstadoExpediente.Anulado && p.Operacion != OperacionExpediente.Eliminacion && p.CodigoACR == "0")
                            {
                                if (user.rolmenu[0].Copiar == true && p.TipoProcedimiento != TipoProcedimiento.EstandarServicio)
                                {
                                    <a class="btn btn-default btn-xs" href="javascript:sut.Procedimiento.copiar(@p.ProcedimientoId)"><i class="fa fa-copy"></i></a> }
                            }

                        }
                        else
                        {

                            if (user.Rol == (short)Rol.Administrador && p.Operacion != OperacionExpediente.Ninguna)
                            {
                                if (user.rolmenu[0].Copiar == true)
                                {
                                    <a class="btn btn-default btn-xs" href="javascript:sut.Procedimiento.copiar(@p.ProcedimientoId)"><i class="fa fa-copy"></i></a>}
                            }

                        }

                    </td>
                    <td class="text-center">
                        @if (userInf.rolmenu[0].Ver == true)
                        {
                            if (exp.EstadoExpediente != EstadoExpediente.Anulado)
                            {

                                if (p.Operacion != OperacionExpediente.Ninguna && p.Operacion != OperacionExpediente.Eliminacion)
                                {
                                    if (p.InfCdnoTerminado)
                                    {
                                        <a href="javascript:sut.Procedimiento.verNotasCiudadano(@p.ProcedimientoId)">@Html.TipoEstadoOpciones2(p.EstadoInfo)</a> }
                                    else
                                    {
                                        if (exp.EstadoExpediente == EstadoExpediente.Aprobado && user.TipoTupa == (short)TipoTupa.Estandar)
                                        {
                                            <a href="javascript:sut.Procedimiento.verNotasCiudadano(@p.ProcedimientoId)">@Html.TipoEstadoOpciones2(p.EstadoInfo)</a> }
                                        else
                                        {

                                            <a href="javascript:sut.Procedimiento.verNotasCiudadano(@p.ProcedimientoId)">@Html.TipoEstadoOpciones2(p.EstadoInfo)</a> }
                                    }
                                }
                                else if (p.Operacion == OperacionExpediente.Ninguna || p.Operacion == OperacionExpediente.Eliminacion)
                                {
                                    <a class="btn btn-primary btn-xs" href="javascript:sut.Procedimiento.verNotasCiudadano(@p.ProcedimientoId)"><i class="fa fa-search"></i></a> }
                            }
                            else
                            {
                                <a class="btn btn-primary btn-xs" href="javascript:sut.Procedimiento.verNotasCiudadano(@p.ProcedimientoId)"><i class="fa fa-search"></i></a> } @*<a class="btn btn-success btn-xs" href="javascript:sut.Procedimiento.verNotasCiudadano(@p.ProcedimientoId)"><i class="fa fa-pencil"></i></a>*@}

                    </td>
                    <td class="text-center">
                        @if (userDatos.rolmenu[0].Ver == true)
                        {
                            if (exp.EstadoExpediente != EstadoExpediente.Anulado)
                            {

                                if (p.Operacion != OperacionExpediente.Ninguna && p.Operacion != OperacionExpediente.Eliminacion)
                                {
                                    if (p.DatosGeneralesTerminado)
                                    {
                                        <a href="javascript:sut.Procedimiento.verDatosGenerales(@p.ProcedimientoId)">@Html.TipoEstadoOpciones2(p.Estadodatos)</a> }
                                    else
                                    {
                                        if (exp.EstadoExpediente == EstadoExpediente.Aprobado && user.TipoTupa == (short)TipoTupa.Estandar)
                                        {
                                            <a href="javascript:sut.Procedimiento.verDatosGenerales(@p.ProcedimientoId)">@Html.TipoEstadoOpciones2(p.Estadodatos)</a> }
                                        else
                                        {

                                            <a href="javascript:sut.Procedimiento.verDatosGenerales(@p.ProcedimientoId)">@Html.TipoEstadoOpciones2(p.Estadodatos)</a> }
                                    }
                                }
                                else if (p.Operacion == OperacionExpediente.Ninguna || p.Operacion == OperacionExpediente.Eliminacion)
                                {
                                    <a class="btn btn-primary btn-xs" href="javascript:sut.Procedimiento.verDatosGenerales(@p.ProcedimientoId)"><i class="fa fa-search"></i></a> }
                            }
                            else
                            {
                                <a class="btn btn-primary btn-xs" href="javascript:sut.Procedimiento.verDatosGenerales(@p.ProcedimientoId)"><i class="fa fa-search"></i></a>}

                        }
                    </td>
                    if (exp.TipoExpediente != TipoExpediente.CargaInicial)
                    {
                        <td class="text-center">
                            @if (userSTL.rolmenu[0].Ver == true)
                            {
                                if (exp.EstadoExpediente != EstadoExpediente.Anulado)
                                {

                                    if (user.TipoTupa != (short)TipoTupa.Estandar && p.Operacion != OperacionExpediente.Ninguna)
                                    {
                                        if (p.TipoProcedimiento != TipoProcedimiento.Estandar)
                                        {
                                            if (p.Operacion != OperacionExpediente.Ninguna && p.Operacion != OperacionExpediente.Eliminacion)
                                            {
                                                if (p.SustTecnicoTerminado)
                                                {
                                                    <a href="javascript:sut.Procedimiento.verSustentoTecnico(@p.ProcedimientoId)">@Html.TipoEstadoOpciones2(p.Estadostl)</a> }
                                                else
                                                {
                                                    <a href="javascript:sut.Procedimiento.verSustentoTecnico(@p.ProcedimientoId)">@Html.TipoEstadoOpciones2(p.Estadostl)</a> }
                                            }
                                            else if (p.Operacion == OperacionExpediente.Ninguna || p.Operacion == OperacionExpediente.Eliminacion)
                                            {
                                                <a class="btn btn-primary btn-xs" href="javascript:sut.Procedimiento.verSustentoTecnico(@p.ProcedimientoId)"><i class="fa fa-search"></i></a> }
                                        }
                                        else if (p.SustTecnicoTerminado)
                                        {
                                            <a href="javascript:sut.Procedimiento.verSustentoTecnico(@p.ProcedimientoId)">@Html.TipoEstadoOpciones2(p.Estadostl)</a> }
                                        else if (p.Operacion != OperacionExpediente.Ninguna && p.Operacion != OperacionExpediente.Eliminacion)
                                        {
                                            <a href="javascript:sut.Procedimiento.verSustentoTecnico(@p.ProcedimientoId)">@Html.TipoEstadoOpciones2(p.Estadostl)</a> }


                                    }
                                    else
                                    {
                                        if (p.Operacion != OperacionExpediente.Ninguna && p.Operacion != OperacionExpediente.Eliminacion)
                                        {
                                            if (p.SustTecnicoTerminado)
                                            {
                                                <a href="javascript:sut.Procedimiento.verSustentoTecnico(@p.ProcedimientoId)">@Html.TipoEstadoOpciones2(p.Estadostl)</a> }
                                            else
                                            {

                                                if (exp.EstadoExpediente == EstadoExpediente.Aprobado && user.TipoTupa == (short)TipoTupa.Estandar)
                                                {
                                                    <a href="javascript:sut.Procedimiento.verSustentoTecnico(@p.ProcedimientoId)">@Html.TipoEstadoOpciones2(p.Estadostl)</a> }
                                                else
                                                {

                                                    <a href="javascript:sut.Procedimiento.verSustentoTecnico(@p.ProcedimientoId)">@Html.TipoEstadoOpciones2(p.Estadostl)</a> }
                                            }
                                        }
                                        else if (p.Operacion == OperacionExpediente.Ninguna || p.Operacion == OperacionExpediente.Eliminacion)
                                        {
                                            <a class="btn btn-primary btn-xs" href="javascript:sut.Procedimiento.verSustentoTecnico(@p.ProcedimientoId)"><i class="fa fa-search"></i></a> }
                                    }
                                }
                                else
                                { <a class="btn btn-primary btn-xs" href="javascript:sut.Procedimiento.verSustentoTecnico(@p.ProcedimientoId)"><i class="fa fa-search"></i></a>}

                            }
                        </td>
                    }


                    if (exp.TipoExpediente != TipoExpediente.CargaInicial)
                    {
                        <td class="text-center">
                            @if (userAsme.rolmenu[0].Ver == true)
                            {
                                {
                                    if (exp.EstadoExpediente != EstadoExpediente.Anulado)
                                    {
                                        if (p.Operacion != OperacionExpediente.Ninguna && p.Operacion != OperacionExpediente.Eliminacion)
                                        {
                                            if (!p.TablaAsmeTerminado)
                                            {
                                                if (exp.EstadoExpediente == EstadoExpediente.Aprobado && user.TipoTupa == (short)TipoTupa.Estandar)
                                                {
                                                    <a href="javascript:sut.Procedimiento.verTablaAsme(@p.ProcedimientoId)">@Html.TipoEstadoOpciones2(p.Estadotablaasme)</a> }
                                                else
                                                {

                                                    <a href="javascript:sut.Procedimiento.verTablaAsme(@p.ProcedimientoId)">@Html.TipoEstadoOpciones2(p.Estadotablaasme)</a> }

                                            }
                                            else
                                            {
                                                <a href="javascript:sut.Procedimiento.verTablaAsme(@p.ProcedimientoId)">@Html.TipoEstadoOpciones2(p.Estadotablaasme)</a> }

                                        }
                                        else if (p.Operacion == OperacionExpediente.Ninguna || p.Operacion == OperacionExpediente.Eliminacion)
                                        {
                                            <a class="btn btn-primary btn-xs" href="javascript:sut.Procedimiento.verTablaAsme(@p.ProcedimientoId)"><i class="fa fa-search"></i></a> }
                                    }
                                    else
                                    {
                                        <a class="btn btn-primary btn-xs" href="javascript:sut.Procedimiento.verTablaAsme(@p.ProcedimientoId)"><i class="fa fa-search"></i></a>}
                                }
                            }
                        </td>
                    }
                    <td>
                        @if (userrptTupa.rolmenu[0].Ver == true)
                        {
                            {
                                if (@p.CodigoCorto != null)
                                {@*<a class="btn btn-default btn-xs" href="@Url.Content("~/General/Reporte/ReporteTupa")?ExpedienteId=@p.ExpedienteId&&ProcedimientoId=@p.ProcedimientoId&&orden=1" target="_blank"><i class="fa fa-file-pdf-o"></i></a>*@
                                @*<a class="btn btn-default btn-xs" href="javascript:sut.Procedimiento.ReporteTupa(@p.ExpedienteId,@p.ProcedimientoId,1)"><i class="fa fa-file-pdf-o"></i></a>
                                    JJJMSP2*@
                                <a class="btn btn-default btn-xs"><input name="ReportePAs" type="checkbox" id=@p.ProcedimientoId></a>}
                        }
                    }
                    </td>
                    if (exp.TipoExpediente != TipoExpediente.CargaInicial)
                    {
                        <td>
                            @if (userptSTL.rolmenu[0].Ver == true)
                            {
                                if (@p.CodigoCorto != null)
                                {@*<a class="btn btn-default btn-xs" href="@Url.Content("~/General/Reporte/FSLT")?tipo=2&id=@p.ProcedimientoId" target="_blank"><i class="fa fa-file-pdf-o"></i></a>*@
                                @*<a class="btn btn-default btn-xs" href="javascript:sut.Procedimiento.FSLT(2,@p.ProcedimientoId)"><i class="fa fa-file-pdf-o"></i></a>}
                                    JJJMSP2 *@
                                <a class="btn btn-default btn-xs"><input name="ReporteFSTLs" type="checkbox" id=@p.ProcedimientoId></a>}
                        }
                        </td>
                    }
                    <td class="text-center">@p.CodigoACR</td>
                }
            </tr>
        }
    }
    else
    {
        <tr>
            <td colspan="10" class="text-center text-bold">NO SE ENCONTRARON REGISTROS.</td>
        </tr>
    }

    <tr>
        <td colspan="6">
            <table class="table table-bordered table-condensed">
                <tbody>
                    <tr>
                        <td class="text-left" style="width: 150px;">Total de Procedimientos/Servicios :</td>
                        <td class="text-right" style="width: 50px;">@ViewBag.Estadisticas["total"]</td>
                    </tr>
                    <tr>
                        <td class="text-left" style="width: 150px;">Información Ciudadana terminados :</td>
                        <td class="text-right" style="width: 50px;">@ViewBag.Estadisticas["Informacion_ciudadano"] / @ViewBag.Estadisticas["total_dg"]</td>
                    </tr>
                    <tr>
                        <td class="text-left" style="width: 150px;">Datos Generales registrados :</td>
                        <td class="text-right" style="width: 50px;">@ViewBag.Estadisticas["datos_generales"] / @ViewBag.Estadisticas["total_dg"]</td>
                    </tr>
                    @if (exp.TipoExpediente != TipoExpediente.CargaInicial)
                    {
                        <tr>
                            <td class="text-left" style="width: 150px;">Sustentos Técnico y Legal terminados :</td>
                            <td class="text-right" style="width: 50px;">@ViewBag.Estadisticas["sustento_tecnico"] / @ViewBag.Estadisticas["total_st"]</td>
                        </tr>
                        <tr>
                            <td class="text-left" style="width: 150px;">Tabla Asme terminados :</td>
                            <td class="text-right" style="width: 50px;">@ViewBag.Estadisticas["tabla_asme"] / @ViewBag.Estadisticas["total_st"]</td>
                        </tr>
                    }
                    <tr>
                        <td></td>
                        <td colspan="2" class="text-right" style="width: 50px;">
                            @if (user.Rol != 1)
                            {
                                if (user.rolmenu[0].Anular == true && exp.EstadoExpediente != EstadoExpediente.Publicado)
                                {
                                    <a href="javascript:sut.Procedimiento.anular()" class="btn btn-danger" style="width: 100%;"><i class="fa fa-remove"></i> Anular Expediente</a>}
                            }

                            @if (exp.Entidad.TipoTupa == TipoTupa.Estandar && user.Rol == 1)
                            {
                                if (exp.EstadoExpediente == EstadoExpediente.Aprobado || exp.EstadoExpediente == EstadoExpediente.Anulado && exp.EstadoExpediente != EstadoExpediente.Publicado)
                                {
                                    if (user.rolmenu[0].Anular == true)
                                    {
                                        <a href="javascript:sut.Procedimiento.anular()" class="btn btn-danger" style="width: 100%;"><i class="fa fa-remove"></i> Anular Expediente</a>}
                                }
                            }

                        </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td colspan="@(exp.TipoExpediente != TipoExpediente.CargaInicial ? 5 : 2)">
            @*JJJMSP2*@
            <table class="table table-bordered table-condensed">
                <tbody>
                    <tr>
                        <td class="col-sm-2 col-xs-12 text-center">
                            <div style="display:inline; width:90px;height:90px;">
                                <canvas id="myCanvas" style="width: 100px; height: 100px; -moz-border-radius: 50%; -webkit-border-radius: 50%; border-radius: 50%; background: rgb(221, 75, 57);"></canvas>
                                <input type="text" class="knob" value="@ViewBag.Estadisticas["Informacion_ciudadano_pct"]" data-width="90" data-height="90" data-fgcolor="#dd4b39" data-readonly="true" disabled="disabled" style="width: 59px; height: 45px; position: relative; vertical-align: middle; margin-top: -88px; margin-left: -80px; border: 0px; background: none; font: bold 36px Arial; text-align: center; color: #f4f4f4; padding: 0px; appearance: none;">
                            </div>
                            <div class="knob-label">Información Ciudadana %</div>
                        </td>
                        <td class="col-sm-2 col-xs-12 text-center">
                            <canvas id="myCanvas2" style="width: 100px; height: 100px; -moz-border-radius: 50%; -webkit-border-radius: 50%; border-radius: 50%; background: rgb(221, 75, 57);"></canvas>
                            <input type="text" disabled class="knob" value="@ViewBag.Estadisticas["datos_generales_pct"]" data-width="90" data-height="90" data-fgColor="#dd4b39" data-readonly="true" style="width: 59px; height: 45px; position: relative; vertical-align: middle; margin-top: -88px; margin-left: -80px; border: 0px; background: none; font: bold 36px Arial; text-align: center; color: #f4f4f4; padding: 0px; appearance: none;">
                            <div class="knob-label">Datos Generales %</div>
                        </td>
                        @if (exp.TipoExpediente != TipoExpediente.CargaInicial)
                        {
                            <td class="col-sm-2 col-xs-12 text-center">
                                <canvas id="myCanvas3" style="width: 100px; height: 100px; -moz-border-radius: 50%; -webkit-border-radius: 50%; border-radius: 50%; background: rgb(221, 75, 57);"></canvas>
                                <input type="text" disabled class="knob" value="@ViewBag.Estadisticas["sustento_tecnico_pct"]" data-width="90" data-height="90" data-fgColor="#dd4b39" data-readonly="true" style="width: 59px; height: 45px; position: relative; vertical-align: middle; margin-top: -88px; margin-left: -80px; border: 0px; background: none; font: bold 36px Arial; text-align: center; color: #f4f4f4; padding: 0px; appearance: none;">
                                <div class="knob-label">Sustento Técnico %</div>
                            </td>
                            <td class="col-sm-2 col-xs-12 text-center">
                                <canvas id="myCanvas4" style="width: 100px; height: 100px; -moz-border-radius: 50%; -webkit-border-radius: 50%; border-radius: 50%; background: rgb(221, 75, 57);"></canvas>
                                <input type="text" disabled class="knob" value="@ViewBag.Estadisticas["tabla_asme_pct"]" data-width="90" data-height="90" data-fgColor="#dd4b39" data-readonly="true" style="width: 59px; height: 45px; position: relative; vertical-align: middle; margin-top: -88px; margin-left: -80px; border: 0px; background: none; font: bold 36px Arial; text-align: center; color: #f4f4f4; padding: 0px; appearance: none;">
                                <div class="knob-label">Tabla Asme %</div>
                            </td>
                        }

                    </tr>
                </tbody>
            </table>
        </td>
        <td colspan="7">
            <table class="table table-bordered table-condensed">
                <tbody>
                    <tr>
                        <td>Ingresar a Sustento de costos :</td>
                        <td colspan="2" class="text-right">
                            @if (exp.TipoExpediente == TipoExpediente.ExpedienteRegular)
                            {
                                if (exp.SustCostosTerminado)
                                {
                                    if (userCostos.rolmenu[0].Ver == true)
                                    {@*<a href="@Url.Content("~/Simplificacion/Configuracion/Resumen/")@exp.ExpedienteId" class="btn btn-primary pull-right" style="width: 100%;"><i class="fa fa-money"></i> Sustento de Costos</a>*@ if (exp.ObsCOSTO == 0)
                                    {
                                        <a href="@Url.Content("~/Simplificacion/Configuracion/Resumen/")@exp.ExpedienteId" class="btn btn-primary pull-right" style="width: 100%;"><i class="fa fa-money"></i> Sustento de Costos</a> }
                                    else
                                    {
                                        <a href="@Url.Content("~/Simplificacion/Configuracion/Resumen/")@exp.ExpedienteId" class="btn btn-danger pull-right" style="width: 100%;"><i class="fa fa-money"></i> Sustento de Costos</a> }
                                }

                            }
                            else
                            {
                                if (userCostos.rolmenu[0].Ver == true)
                                { @*<a href="@Url.Content("~/Simplificacion/Configuracion/Resumen/")@exp.ExpedienteId" class="btn btn-success pull-right" style="width: 100%;"><i class="fa fa-money"></i> Sustento de Costos</a>*@ if (exp.ObsCOSTO == 0)
                                {
                                    <a href="@Url.Content("~/Simplificacion/Configuracion/Resumen/")@exp.ExpedienteId" class="btn btn-primary pull-right" style="width: 100%;"><i class="fa fa-money"></i> Sustento de Costos</a> }
                                else
                                {
                                    <a href="@Url.Content("~/Simplificacion/Configuracion/Resumen/")@exp.ExpedienteId" class="btn btn-danger pull-right" style="width: 100%;"><i class="fa fa-money"></i> Sustento de Costos</a>}
                            }

                        }
                    }

                        </td>
                    </tr>
                    @*JJJMSP2 INI*@
                    <tr>
                        <td>Descargar Reporte :</td>
                        <td>
                            <select id="cbFilterReporte" class="form-control input-sm">
                                <option value="0">(Seleccione un Reporte)</Seleccionar></option>
                                @if (userrptTupaCompleto.rolmenu[0].Ver == true)
                                {
                                    <option value="1">Reporte TUPA</option>
                                    <option value="2">Reporte TUPA Seleccionados</option>
                                }
                                @if (exp.TipoExpediente != TipoExpediente.CargaInicial)
                                {
                                    if (userrptSTLCompleto.rolmenu[0].Ver == true)
                                    {
                                        <option value="3">Reporte STL</option>
                                        <option value="4">Reporte STL Seleccionados</option>
                                    }
                                }
                                @if (userrptTupaCompleto.rolmenu[0].Ver == true && exp.TipoExpediente != TipoExpediente.CargaInicial && userrptSTLCompleto.rolmenu[0].Ver == true)
                                {
                                    <option value="5">Reporte Todos Seleccionados</option>
                                }
                            </select>
                            <a href="javascript:sut.Procedimientame.ReporteFilter(@exp.ExpedienteId)" class="btn btn-default" style="width: 100%;"><i class="fa  fa-file-pdf-o"></i> Descargar Reporte</a>
                        </td>
                    </tr>
                    @*
                        <tr>
                            <td>Descargar Reporte TUPA completo :</td>
                            <td colspan="2" class="text-right">
                                @if (userrptTupaCompleto.rolmenu[0].Ver == true)
                                {@*<a href="@Url.Content("~/General/Reporte/ReporteTupa")?ExpedienteId=@Model.ExpedienteId&&ProcedimientoId=0&&orden=1" target="_blank" class="btn btn-default"><i class="fa  fa-file-pdf-o"></i> Reporte TUPA</a> @
                                <a href="javascript:sut.Procedimiento.ReporteTupa(@exp.ExpedienteId,0,1)" class="btn btn-default" style="width: 100%;"><i class="fa  fa-file-pdf-o"></i> Reporte TUPA</a>
                                <a href="javascript:sut.Procedimientame.ReporteTupaSeleccion(@exp.ExpedienteId)" class="btn btn-default" style="width: 100%;"><i class="fa  fa-file-pdf-o"></i> Reporte PA seleccionados</a>
                            }
                            </td>
                        </tr>
                        <tr>
                            <td>Descargar Reporte Sustento Tecnico Legal :</td>
                            <td colspan="2" class="text-right">
                                @if (exp.TipoExpediente != TipoExpediente.CargaInicial)
                                {

                                    if (userrptSTLCompleto.rolmenu[0].Ver == true)
                                    {@*<a href="@Url.Content("~/General/Reporte/FSLT")?tipo=1&id=@Model.ExpedienteId" target="_blank" class="btn btn-default"><i class="fa fa-download"></i>   Reporte  STL</a> @
                                    <a href="javascript:sut.Procedimiento.FSLT(1,@exp.ExpedienteId)" class="btn btn-default" style="width: 100%;"><i class="fa fa-download"></i>  Reporte  STL</a>
                                    <a href="javascript:sut.Procedimientame.ReporteFSTLSeleccion(2,@exp.ExpedienteId)" class="btn btn-default" style="width: 100%;"><i class="fa fa-download"></i> Reporte STL Seleccionados</a>
                                }
                            }
                            </td>
                        </tr>*@
                    @*JJJMSP2 FIN*@
                    <tr>
                        <td></td>
                        <td colspan="2" class="text-right">
                        </td>
                    </tr>

                    <tr>
                        @if (exp.TipoExpediente != TipoExpediente.CargaInicial)
                        {

                            if (@ViewBag.Estadisticas["Informacion_ciudadano_pct"] == 100 && @ViewBag.Estadisticas["datos_generales_pct"] == 100 && @ViewBag.Estadisticas["sustento_tecnico_pct"] == 100 && @ViewBag.Estadisticas["tabla_asme_pct"] == 100)
                            {
                                if (user.Rol == 1)
                                {
                                    <td> Reporte TUPA el Peruano :</td>
                                    <td colspan="2" class="text-right">
                                        @*<a href="javascript:sut.Procedimiento.ReporteWord(@exp.ExpedienteId)" title="Solicitar archivo word" class="btn btn-default" style="width: 100%;"><i class="fa fa-download"></i> Word</a>*@
                                        <a href="javascript:sut.Procedimiento.RptTupaPer(@exp.ExpedienteId,0,1)" class="btn btn-default" style="width: 100%;"><i class="fa  fa-file-pdf-o"></i> TUPA Diario</a>
                                    </td>
                                } @*else if (exp.EstadoReporteWord == 1)
                                    {
                                        <td>Solicitar Reporte TUPA en Word :</td>
                                        <td colspan="2" class="text-right">
                                            <a href="#" class="btn btn-default" title="Procesando archivo word" style="width: 100%;"><i class="fa fa-download"></i>  Procesando...</a>
                                        </td>

                                    }*@ @*else if (exp.EstadoReporteWord == 2)
                                    {
                                        <td>Volver a solicitar Reporte TUPA en Word en caso se modifique el expediente :</td>
                                        <td class="text-right">
                                            <a href="javascript:sut.Procedimiento.ReporteWord(@exp.ExpedienteId)" title="volver a generar archivo word" class="btn btn-default"><i class="fa fa-download"></i> Generar</a>
                                        </td>
                                        <td class="text-right">
                                            <a class="btn btn-primary btn-xs" data-placement="left" title="Descargar archivo word" href="@Url.Content("~/General/Adjunto/Descargar/")@exp.ArchivoAdjuntoId"><i class="fa fa-download"></i></a>
                                        </td>

                                    }*@}
                            }
                    </tr>

                </tbody>
            </table>
        </td>
    </tr>
</tbody>

@*JJJMSP2 INI*@
@if (Model.Count() > 0)
{
    Procedimiento registroMasReciente = Model.OrderByDescending(p => p.FecModificacion).FirstOrDefault();
    long procedimientoIdMasReciente = registroMasReciente?.ProcedimientoId ?? 0;

    <script>
        const procedimientoIds = [];
        const FSTLIds = [];
        sut.Procedimientame = {
            ReporteFilter: (expedienteId) => {
                selecion = $("#cbFilterReporte").val();
                if (selecion == 0) {
                    showNotification('top', 'right', 'Seleccione algun reporte', 3);
                }
                if (selecion == 1) {
                    sut.Procedimiento.ReporteTupa(expedienteId, 0, 1);
                }
                if (selecion == 2) {
                    sut.Procedimientame.ReporteTupaSeleccion(@exp.ExpedienteId);
                }
                if (selecion == 3) {
                    sut.Procedimiento.FSLT(1,@exp.ExpedienteId);
                }
                if (selecion == 4) {
                    sut.Procedimientame.ReporteFSTLSeleccion(2,@exp.ExpedienteId);
                }
                if (selecion == 5) {
                    sut.Procedimientame.ReporteTupaSeleccion(@exp.ExpedienteId);
                    sut.Procedimientame.ReporteFSTLSeleccion(2,@exp.ExpedienteId);
                }
                if (selecion == 6) {
                    //"@Url.Content("~/General/Reporte/TablaAsmefactortupa")?ExpedienteId=@exp.ExpedienteId";
                }
            },
            ReporteTupaSeleccion: (expedienteId) => {
                if (procedimientoIds.length > 0) {
                    showNotification('top', 'right', 'PA.Ids Envio PDF', 1);
                    //console.log('procedimientoIds enviando:', procedimientoIds);
                    sut.Procedimiento.ReporteTupa(expedienteId, procedimientoIds, 1);
                } else {
                    showNotification('top', 'right', 'La lista de PA.Ids está vacía', 3);
                }
            },
            ReporteFSTLSeleccion: (orden, Expedienteid) => {
                if (FSTLIds.length > 0) {
                    showNotification('top', 'right', 'STL.Ids Envio PDF: ' + Expedienteid, 1);
                    //console.log('FSTLIds enviando:', FSTLIds);
                    sut.Procedimiento.FSLT(orden, FSTLIds);
                } else {
                    showNotification('top', 'right', 'La lista de STL.Ids está vacía', 3);
                }
            },
        };

        $(document).ready(function () {
            // Agrega el evento 'click' a los checkboxes
            $("input[type='checkbox'][name='ReportePAs']").click(function (e) {
                var chk = $(e.target);
                const procedimientoId = chk.attr('id');
                if (chk.is(':checked')) {
                    // Agregar el ID al arreglo de procedimientoIds si el checkbox está seleccionado
                    procedimientoIds.push(procedimientoId);
                    showNotification('top', 'right', 'PA.Ids seleccionado: ' + procedimientoId, 2);
                } else {
                    // Eliminar el ID del arreglo de procedimientoIds si el checkbox se deselecciona
                    const index = procedimientoIds.indexOf(procedimientoId);
                    if (index !== -1) {
                        procedimientoIds.splice(index, 1);
                    }
                }
                console.log('PA.Ids:', procedimientoIds);
            });
            $("input[type='checkbox'][name='ReporteFSTLs']").click(function (e) {
                var chk = $(e.target);
                const procedimientoId = chk.attr('id');
                if (chk.is(':checked')) {
                    // Agregar el ID al arreglo de procedimientoIds si el checkbox está seleccionado
                    FSTLIds.push(procedimientoId);
                    showNotification('top', 'right', 'STL.Ids seleccionado: ' + procedimientoId, 2);
                } else {
                    // Eliminar el ID del arreglo de procedimientoIds si el checkbox se deselecciona
                    const index = FSTLIds.indexOf(procedimientoId);
                    if (index !== -1) {
                        FSTLIds.splice(index, 1);
                    }
                }
                console.log('STL.Ids:', FSTLIds);
            });
            var procedimientoIdMasReciente = '@procedimientoIdMasReciente';
            $('#tblLista tbody tr').each(function () {
                var procedimientoId = $(this).find('input[name="ReportePAs"]').attr('id');
                if (procedimientoId === procedimientoIdMasReciente) {
                    $(this).css("background-color", "#A1DCF2");
                }
            });
        });
    </script>
}@*JJJMSP2 FIN*@