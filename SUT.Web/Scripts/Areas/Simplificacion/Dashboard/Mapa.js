var geojsonFeature = { "type": "FeatureCollection", "features": [{ "type": "Feature", "geometry": { "type": "Polygon", "coordinates": [[[-77.758934, -6.964508], [-77.745606, -6.665158], [-77.381733, -6.697589], [-77.436149, -6.605217], [-77.28666, -6.331023], [-77.171732, -6.38117], [-77.132725, -6.302421], [-77.395498, -6.039377], [-77.669225, -5.980365], [-77.763929, -5.819709], [-77.682066, -5.338396], [-77.695978, -5.16366], [-77.822277, -5.081793], [-77.794622, -4.763007], [-77.585943, -4.475013], [-77.538123, -4.028708], [-77.776479, -3.409131], [-77.808616, -2.986125], [-78.171209, -3.350828], [-78.149169, -3.480796], [-78.31874, -3.395069], [-78.56611, -3.993301], [-78.709113, -5.179629], [-78.515178, -5.454349], [-78.712015, -5.830443], [-78.136028, -6.526302], [-77.999506, -6.970532], [-77.758934, -6.964508]]] }, "properties": { "NOMBDEP": "AMAZONAS", "codigo_departamento": "01" } }, { "type": "Feature", "geometry": { "type": "Polygon", "coordinates": [[[-77.317486, -8.530152], [-77.647111, -8.050281], [-77.897904, -8.076016], [-78.11595, -8.3101], [-78.193525, -8.600111], [-78.518139, -8.752981], [-78.644924, -8.969228], [-77.886271, -10.61192], [-77.771376, -10.571615], [-77.692391, -10.320902], [-77.597593, -10.380364], [-77.736781, -10.563212], [-77.64426, -10.527409], [-77.49496, -10.746103], [-77.190988, -10.552133], [-76.808422, -10.084846], [-76.901383, -9.770496], [-77.048488, -9.647461], [-76.842295, -9.261734], [-76.757488, -9.362197], [-76.725744, -9.256635], [-77.109797, -8.970205], [-77.317486, -8.530152]]] }, "properties": { "NOMBDEP": "ANCASH", "codigo_departamento": "02" } }, { "type": "Feature", "geometry": { "type": "Polygon", "coordinates": [[[-72.471771, -14.661399], [-72.50291, -14.551662], [-72.081488, -14.202303], [-72.135332, -13.783065], [-72.894086, -13.390127], [-73.48091, -13.431371], [-73.797029, -13.199943], [-73.791921, -13.64096], [-73.669533, -13.734849], [-73.747888, -13.763366], [-73.51225, -14.268158], [-73.565281, -14.775834], [-73.485027, -14.84257], [-73.390403, -14.716062], [-73.009412, -14.637389], [-72.846825, -14.759824], [-72.789696, -14.650213], [-72.471771, -14.661399]]] }, "properties": { "NOMBDEP": "APURIMAC", "codigo_departamento": "03" } }, { "type": "Feature", "geometry": { "type": "Polygon", "coordinates": [[[-75.073326, -15.442942], [-73.699371, -16.220703], [-72.44722, -16.703957], [-71.857727, -17.158867], [-71.490799, -17.285006], [-71.302246, -17.093851], [-71.425499, -16.740643], [-71.289093, -16.726458], [-71.245644, -16.466864], [-70.952926, -16.460989], [-70.98629, -16.309946], [-70.853882, -16.241466], [-70.812569, -16.053961], [-70.993957, -15.454842], [-71.174332, -15.424457], [-71.143578, -15.120561], [-71.50705, -14.976275], [-71.587601, -15.125595], [-71.802956, -15.067441], [-71.74596, -14.93987], [-71.987915, -14.63295], [-72.047127, -14.875063], [-72.144699, -14.777713], [-72.406479, -14.827085], [-72.471771, -14.661399], [-72.789696, -14.650213], [-73.002785, -14.814986], [-73.004242, -15.064127], [-73.174545, -15.306607], [-73.684364, -15.437484], [-73.860054, -15.326117], [-74.068649, -15.629887], [-74.094521, -15.392003], [-74.300124, -15.478395], [-74.39872, -15.181463], [-74.762299, -15.098055], [-75.073326, -15.442942]], [[-71.185585, -16.384989], [-71.096443, -16.350771], [-71.103233, -16.408703], [-71.185585, -16.384989]]] }, "properties": { "NOMBDEP": "AREQUIPA", "codigo_departamento": "04" } }, { "type": "Feature", "geometry": { "type": "Polygon", "coordinates": [[[-74.345946, -12.173737], [-74.581177, -12.332669], [-74.42245, -12.44521], [-74.270165, -13.02555], [-74.38623, -13.02931], [-74.69946, -13.36351], [-74.89772, -13.39531], [-74.771388, -13.606499], [-74.770287, -14.089793], [-75.02913, -14.07195], [-75.138049, -14.414656], [-75.0599, -14.622618], [-74.895418, -14.54508], [-74.69384, -14.838155], [-74.664267, -15.044696], [-74.762299, -15.098055], [-74.39872, -15.181463], [-74.300124, -15.478395], [-74.094521, -15.392003], [-74.068649, -15.629887], [-73.860054, -15.326117], [-73.684364, -15.437484], [-73.294525, -15.39233], [-73.004242, -15.064127], [-73.002785, -14.814986], [-72.846825, -14.759824], [-73.009412, -14.637389], [-73.390403, -14.716062], [-73.485027, -14.84257], [-73.565281, -14.775834], [-73.51225, -14.268158], [-73.747888, -13.763366], [-73.669533, -13.734849], [-73.791921, -13.64096], [-73.82282, -13.285052], [-73.75644, -13.170715], [-73.48091, -13.431371], [-73.211929, -13.419102], [-73.980452, -12.242588], [-74.121439, -12.333601], [-74.345946, -12.173737]], [[-73.740172, -15.265978], [-73.640104, -15.291993], [-73.684904, -15.334225], [-73.740172, -15.265978]]] }, "properties": { "NOMBDEP": "AYACUCHO", "codigo_departamento": "05" } }, { "type": "Feature", "geometry": { "type": "Polygon", "coordinates": [[[-79.322586, -7.025684], [-79.347131, -7.336637], [-79.065428, -7.472709], [-78.992149, -7.660949], [-78.760125, -7.401984], [-78.624572, -7.548559], [-78.359984, -7.500394], [-78.382819, -7.630107], [-78.224653, -7.759331], [-77.741372, -7.466695], [-78.136028, -6.526302], [-78.712015, -5.830443], [-78.515178, -5.454349], [-78.709113, -5.179629], [-78.600646, -4.773387], [-78.705955, -4.623873], [-78.83922, -4.656038], [-79.011947, -5.013986], [-79.21007, -4.965242], [-79.378408, -5.190521], [-79.272396, -5.518982], [-79.39832, -5.537018], [-79.334068, -5.893631], [-79.418609, -5.9701], [-79.223995, -6.055007], [-79.252261, -6.226688], [-79.45349, -6.396842], [-79.120848, -6.77697], [-79.311009, -6.901342], [-79.322586, -7.025684]]] }, "properties": { "NOMBDEP": "CAJAMARCA", "codigo_departamento": "06" } }, { "type": "Feature", "geometry": { "type": "Polygon", "coordinates": [[[-77.187098, -11.828361], [-77.111533, -12.079492], [-77.089904, -11.901787], [-77.187098, -11.828361]]] }, "properties": { "NOMBDEP": "CALLAO", "codigo_departamento": "07" } }, { "type": "Feature", "geometry": { "type": "Polygon", "coordinates": [[[-72.471771, -14.661399], [-72.406479, -14.827085], [-72.144699, -14.777713], [-72.047127, -14.875063], [-71.987915, -14.63295], [-71.74596, -14.93987], [-71.802956, -15.067441], [-71.636024, -15.139139], [-71.50705, -14.976275], [-71.315628, -15.120225], [-71.20684, -15.071889], [-71.174332, -15.424457], [-71.071747, -15.449273], [-70.952299, -15.289843], [-70.975483, -14.764134], [-71.113676, -14.666732], [-70.80893, -14.124199], [-70.831273, -13.858932], [-70.400073, -13.371739], [-70.388467, -13.192389], [-70.842961, -13.067048], [-71.040945, -13.26875], [-71.173042, -12.983335], [-71.415244, -12.894259], [-71.552133, -12.709302], [-71.746941, -12.796107], [-71.978595, -12.683331], [-72.071132, -12.511484], [-71.973031, -12.320543], [-72.105512, -12.23806], [-72.094447, -12.085191], [-72.337466, -11.968075], [-72.428739, -11.708972], [-72.239258, -11.345061], [-72.609987, -11.428238], [-72.951909, -11.33063], [-72.989665, -11.198797], [-73.331331, -11.311265], [-73.60827, -11.66016], [-73.361887, -12.135965], [-73.590465, -12.376944], [-73.801894, -12.220297], [-73.980452, -12.242588], [-73.287354, -13.371943], [-72.894086, -13.390127], [-72.135332, -13.783065], [-72.081488, -14.202303], [-72.50291, -14.551662], [-72.471771, -14.661399]], [[-71.24459, -14.483272], [-71.248167, -14.438879], [-71.156514, -14.5], [-71.24459, -14.483272]]] }, "properties": { "NOMBDEP": "CUSCO", "codigo_departamento": "08" } }, { "type": "Feature", "geometry": { "type": "Polygon", "coordinates": [[[-75.05905, -14.12962], [-74.770287, -14.089793], [-74.771388, -13.606499], [-74.89772, -13.39531], [-74.69946, -13.36351], [-74.38623, -13.02931], [-74.270165, -13.02555], [-74.42245, -12.44521], [-74.581177, -12.332669], [-74.38481, -12.26863], [-74.352384, -12.147765], [-74.624165, -11.985182], [-74.837374, -12.070818], [-75.047053, -12.011564], [-75.215515, -12.463421], [-75.579613, -12.641484], [-75.5075, -12.777155], [-75.805985, -13.401433], [-75.502916, -13.36595], [-75.545502, -13.889482], [-75.05905, -14.12962]]] }, "properties": { "NOMBDEP": "HUANCAVELICA", "codigo_departamento": "09" } }, { "type": "Feature", "geometry": { "type": "Polygon", "coordinates": [[[-77.317486, -8.530152], [-77.109797, -8.970205], [-76.733734, -9.208967], [-76.757488, -9.362197], [-76.842295, -9.261734], [-77.048488, -9.647461], [-76.813676, -9.961572], [-76.906246, -10.274186], [-76.725054, -10.485715], [-76.33579, -10.28632], [-76.30931, -10.40562], [-75.97581, -10.479336], [-75.590327, -9.952473], [-75.287938, -9.870278], [-75.30307, -9.783622], [-74.999442, -9.838454], [-74.804426, -9.729822], [-74.589439, -9.303176], [-74.678094, -9.094039], [-74.525351, -8.749316], [-74.617816, -8.548719], [-74.846683, -8.661235], [-74.934164, -8.930225], [-75.143303, -8.972193], [-75.282723, -9.309832], [-75.562445, -9.400172], [-75.670838, -9.396644], [-75.875861, -9.021459], [-75.984963, -8.32215], [-76.087176, -8.336906], [-76.230154, -8.796295], [-76.333468, -8.429474], [-76.466167, -8.569743], [-77.049801, -8.553715], [-77.133844, -8.440021], [-77.317486, -8.530152]]] }, "properties": { "NOMBDEP": "HUANUCO", "codigo_departamento": "10" } }, { "type": "Feature", "geometry": { "type": "Polygon", "coordinates": [[[-74.762299, -15.098055], [-74.663451, -14.907934], [-74.895418, -14.54508], [-75.0599, -14.622618], [-75.108842, -14.032885], [-75.545502, -13.889482], [-75.502916, -13.36595], [-75.805985, -13.401433], [-75.614393, -12.964933], [-75.802062, -13.06043], [-75.937683, -12.991325], [-76.244793, -13.323514], [-76.19766, -13.640877], [-76.260963, -13.865602], [-76.371291, -13.808881], [-76.396328, -13.908898], [-76.282516, -13.918049], [-76.290195, -14.161512], [-76.14357, -14.227621], [-75.916465, -14.659176], [-75.502445, -14.918717], [-75.073326, -15.442942], [-74.762299, -15.098055]]] }, "properties": { "NOMBDEP": "ICA", "codigo_departamento": "11" } }, { "type": "Feature", "geometry": { "type": "Polygon", "coordinates": [[[-74.572995, -10.912602], [-75.074316, -10.66581], [-75.465222, -10.901127], [-75.49025, -10.75683], [-75.838381, -10.886299], [-75.992672, -10.820985], [-76.12293, -10.96264], [-76.029656, -11.087197], [-76.259846, -10.921432], [-76.26294, -11.1496], [-76.518402, -11.116078], [-76.052585, -11.948236], [-75.637756, -12.114185], [-75.579613, -12.641484], [-75.215515, -12.463421], [-75.047053, -12.011564], [-74.837374, -12.070818], [-74.624165, -11.985182], [-74.187618, -12.314376], [-73.801894, -12.220297], [-73.63715, -12.378368], [-73.361887, -12.135965], [-73.60827, -11.66016], [-73.419749, -11.383938], [-73.560261, -10.860609], [-73.7572, -10.735905], [-73.861304, -11.14553], [-74.005498, -10.993193], [-74.373655, -11.056522], [-74.572995, -10.912602]]] }, "properties": { "NOMBDEP": "JUNIN", "codigo_departamento": "12" } }, { "type": "Feature", "geometry": { "type": "Polygon", "coordinates": [[[-78.644924, -8.969228], [-78.518139, -8.752981], [-78.193525, -8.600111], [-78.11595, -8.3101], [-77.897904, -8.076016], [-77.647111, -8.050281], [-77.317486, -8.530152], [-76.913745, -8.32609], [-77.019562, -8.052687], [-77.385473, -8.055387], [-77.758934, -6.964508], [-77.999506, -6.970532], [-77.741372, -7.466695], [-78.224653, -7.759331], [-78.382819, -7.630107], [-78.359984, -7.500394], [-78.624572, -7.548559], [-78.662467, -7.412998], [-78.841619, -7.437617], [-78.992149, -7.660949], [-79.065428, -7.472709], [-79.347131, -7.336637], [-79.267275, -7.192394], [-79.400762, -6.956928], [-79.690621, -7.177127], [-79.465707, -7.711934], [-78.986088, -8.212361], [-78.644924, -8.969228]]] }, "properties": { "NOMBDEP": "LA LIBERTAD", "codigo_departamento": "13" } }, { "type": "Feature", "geometry": { "type": "Polygon", "coordinates": [[[-80.627133, -6.37208], [-79.986029, -6.747053], [-79.690621, -7.177127], [-79.455005, -6.946314], [-79.322586, -7.025684], [-79.311009, -6.901342], [-79.120848, -6.77697], [-79.45349, -6.396842], [-79.252261, -6.226688], [-79.223995, -6.055007], [-79.737328, -5.83765], [-79.903055, -5.491449], [-79.99483, -5.751945], [-80.327414, -5.947441], [-80.627133, -6.37208]]] }, "properties": { "NOMBDEP": "LAMBAYEQUE", "codigo_departamento": "14" } }, { "type": "Feature", "geometry": { "type": "Polygon", "coordinates": [[[-76.906246, -10.274186], [-77.41543, -10.72998], [-77.577174, -10.72857], [-77.64426, -10.527409], [-77.736781, -10.563212], [-77.597593, -10.380364], [-77.692391, -10.320902], [-77.771376, -10.571615], [-77.886271, -10.61192], [-77.657828, -10.946506], [-77.642924, -11.304477], [-77.216037, -11.638969], [-77.111533, -12.079492], [-76.777361, -12.394062], [-76.799309, -12.50908], [-76.244793, -13.323514], [-75.937683, -12.991325], [-75.802062, -13.06043], [-75.614393, -12.964933], [-75.5075, -12.777155], [-75.564096, -12.336289], [-75.694305, -12.042691], [-76.014254, -11.98433], [-76.187707, -11.59279], [-76.371665, -11.505213], [-76.725054, -10.485715], [-76.906246, -10.274186]]] }, "properties": { "NOMBDEP": "LIMA", "codigo_departamento": "15" } }, { "type": "Feature", "geometry": { "type": "Polygon", "coordinates": [[[-73.983033, -7.534361], [-73.923734, -7.362212], [-73.694879, -7.299067], [-73.79842, -7.113061], [-73.71046, -6.84019], [-73.111699, -6.446916], [-73.249941, -6.133078], [-72.958983, -5.65636], [-72.88789, -5.165821], [-71.864998, -4.526451], [-70.948289, -4.376022], [-70.644622, -4.126947], [-70.293949, -4.159307], [-70.180836, -4.355405], [-70.158144, -4.277209], [-69.974418, -4.332777], [-69.955689, -4.207643], [-70.276307, -3.837631], [-70.711147, -3.790296], [-70.066039, -2.684096], [-70.357906, -2.489323], [-70.638294, -2.465767], [-70.879387, -2.220893], [-71.371086, -2.389352], [-71.740594, -2.142197], [-71.961961, -2.357141], [-72.368112, -2.489532], [-72.595519, -2.366553], [-72.851799, -2.435783], [-73.066414, -2.35524], [-73.168764, -2.22463], [-73.112765, -1.872815], [-73.536955, -1.688365], [-73.478568, -1.522094], [-73.619949, -1.261314], [-74.267218, -0.982356], [-74.421337, -0.504523], [-75.183596, -0.038606], [-75.306241, -0.155418], [-75.610496, -0.113355], [-75.2276, -0.55143], [-75.216238, -0.970834], [-75.3867, -0.929739], [-75.580934, -1.546367], [-76.044989, -2.128043], [-76.631865, -2.589689], [-77.808616, -2.986125], [-77.776479, -3.409131], [-77.538123, -4.028708], [-77.585943, -4.475013], [-77.794622, -4.763007], [-77.822277, -5.081793], [-77.695978, -5.16366], [-77.695958, -5.411053], [-77.558119, -5.425578], [-77.461943, -5.58414], [-76.835451, -5.745555], [-76.747697, -6.003643], [-76.412269, -5.950664], [-76.127211, -6.176705], [-75.71502, -6.13827], [-75.571105, -6.003988], [-75.501233, -6.767046], [-75.697699, -6.868603], [-76.051043, -6.810923], [-76.010717, -7.07838], [-76.213111, -7.310143], [-75.966979, -7.960359], [-75.829493, -7.973496], [-75.984963, -8.32215], [-75.94575, -8.716139], [-75.70701, -8.439325], [-75.44079, -8.436833], [-75.430096, -8.166598], [-75.243885, -8.155518], [-75.142491, -7.978641], [-74.98226, -7.968986], [-74.896438, -8.081268], [-74.627984, -7.939828], [-74.515718, -7.777173], [-74.642902, -7.500086], [-74.501769, -7.266078], [-73.983033, -7.534361]]] }, "properties": { "NOMBDEP": "LORETO", "codigo_departamento": "16" } }, { "type": "Feature", "geometry": { "type": "Polygon", "coordinates": [[[-70.388467, -13.192389], [-70.402868, -13.114413], [-69.647227, -13.341242], [-68.871873, -13.003926], [-68.654471, -12.49943], [-69.562928, -10.966836], [-69.900525, -10.920605], [-70.307793, -11.070498], [-70.527832, -10.934277], [-70.613754, -11.000168], [-70.613885, -9.916855], [-70.705111, -10.158681], [-71.196213, -10.579861], [-71.357317, -10.951545], [-72.18209, -11.010242], [-72.121406, -11.107141], [-72.428739, -11.708972], [-72.337466, -11.968075], [-72.094447, -12.085191], [-72.105512, -12.23806], [-71.973031, -12.320543], [-72.071132, -12.511484], [-71.978595, -12.683331], [-71.746941, -12.796107], [-71.552133, -12.709302], [-71.415244, -12.894259], [-71.173042, -12.983335], [-71.040945, -13.26875], [-70.842961, -13.067048], [-70.388467, -13.192389]]] }, "properties": { "NOMBDEP": "MADRE DE DIOS", "codigo_departamento": "17" } }, { "type": "Feature", "geometry": { "type": "Polygon", "coordinates": [[[-71.139443, -17.821482], [-70.9125, -17.68737], [-70.684221, -17.22498], [-70.449579, -17.081292], [-70.441605, -16.841227], [-70.307611, -16.773047], [-70.205574, -16.808125], [-70.247182, -16.952444], [-70.146625, -16.93873], [-69.995563, -16.729776], [-70.382114, -16.384955], [-70.40979, -16.076346], [-70.560225, -15.988298], [-70.820198, -15.978468], [-70.853882, -16.241466], [-70.98629, -16.309946], [-70.952926, -16.460989], [-71.245644, -16.466864], [-71.289093, -16.726458], [-71.425499, -16.740643], [-71.302246, -17.093851], [-71.490799, -17.285006], [-71.372219, -17.681713], [-71.139443, -17.821482]]] }, "properties": { "NOMBDEP": "MOQUEGUA", "codigo_departamento": "18" } }, { "type": "Feature", "geometry": { "type": "Polygon", "coordinates": [[[-76.278859, -10.923451], [-76.12293, -10.96264], [-75.992672, -10.820985], [-75.838381, -10.886299], [-75.57382, -10.746991], [-75.459529, -10.785949], [-75.465222, -10.901127], [-75.074316, -10.66581], [-74.614102, -10.904625], [-74.385681, -10.811767], [-74.132673, -10.604911], [-74.276711, -10.374074], [-74.231661, -10.185052], [-74.400608, -10.070519], [-74.496763, -9.59335], [-74.677103, -9.428324], [-74.804426, -9.729822], [-74.999442, -9.838454], [-75.30307, -9.783622], [-75.287938, -9.870278], [-75.590327, -9.952473], [-75.97581, -10.479336], [-76.30931, -10.40562], [-76.33579, -10.28632], [-76.69682, -10.442486], [-76.580162, -11.010842], [-76.26294, -11.1496], [-76.278859, -10.923451]]] }, "properties": { "NOMBDEP": "PASCO", "codigo_departamento": "19" } }, { "type": "Feature", "geometry": { "type": "Polygon", "coordinates": [[[-79.21007, -4.965242], [-79.628141, -4.439109], [-79.793885, -4.492982], [-80.10424, -4.290957], [-80.389543, -4.486111], [-80.453777, -4.385615], [-80.32883, -4.223133], [-80.487332, -4.083129], [-80.623221, -4.231779], [-81.041418, -4.087547], [-81.237053, -4.250676], [-81.328103, -4.681885], [-81.060219, -5.039283], [-81.194553, -5.212119], [-80.852547, -5.635488], [-80.891488, -5.80982], [-81.068447, -5.785746], [-81.14926, -5.98124], [-80.627133, -6.37208], [-80.327414, -5.947441], [-79.99483, -5.751945], [-79.903055, -5.491449], [-79.737328, -5.83765], [-79.418609, -5.9701], [-79.334068, -5.893631], [-79.39832, -5.537018], [-79.272396, -5.518982], [-79.378408, -5.190521], [-79.21007, -4.965242]]] }, "properties": { "NOMBDEP": "PIURA", "codigo_departamento": "20" } }, { "type": "Feature", "geometry": { "type": "MultiPolygon", "coordinates": [[[[-68.918389, -16.403721], [-68.814217, -16.319773], [-68.918399, -16.233297], [-68.918389, -16.403721]]], [[[-69.64132, -17.28745], [-69.170014, -16.727535], [-68.996102, -16.656576], [-69.084014, -16.46265], [-68.97685, -16.257083], [-69.494324, -16.208061], [-69.451735, -15.99361], [-69.671739, -15.956605], [-69.822121, -15.785446], [-69.883037, -15.890196], [-70.034204, -15.722986], [-69.892918, -15.593427], [-69.750767, -15.72908], [-69.942891, -15.396677], [-69.89429, -15.295113], [-69.699213, -15.233639], [-69.331118, -15.537947], [-69.131529, -15.233994], [-69.361582, -14.949191], [-69.353797, -14.801666], [-69.225265, -14.740702], [-68.962406, -14.220055], [-68.827799, -14.21942], [-68.978097, -13.978037], [-68.917744, -13.813664], [-69.066119, -13.688314], [-68.845451, -13.245914], [-68.871873, -13.003926], [-69.647227, -13.341242], [-70.402868, -13.114413], [-70.400073, -13.371739], [-70.831273, -13.858932], [-70.80893, -14.124199], [-71.113676, -14.666732], [-70.975483, -14.764134], [-70.952299, -15.289843], [-71.038971, -15.405166], [-70.936142, -15.78484], [-70.76864, -16.0168], [-70.40979, -16.076346], [-70.382114, -16.384955], [-70.001472, -16.656574], [-70.146625, -16.93873], [-70.039719, -17.127968], [-69.64132, -17.28745]], [[-69.887743, -15.206933], [-70.116164, -15.16793], [-70.044952, -15.110658], [-69.887743, -15.206933]]]] }, "properties": { "NOMBDEP": "PUNO", "codigo_departamento": "21" } }, { "type": "Feature", "geometry": { "type": "Polygon", "coordinates": [[[-75.984963, -8.32215], [-75.829493, -7.973496], [-75.966979, -7.960359], [-76.213111, -7.310143], [-76.010717, -7.07838], [-76.051043, -6.810923], [-75.697699, -6.868603], [-75.501233, -6.767046], [-75.571105, -6.003988], [-75.71502, -6.13827], [-76.223631, -6.166031], [-76.412269, -5.950664], [-76.747697, -6.003643], [-76.835451, -5.745555], [-77.743035, -5.406467], [-77.763929, -5.819709], [-77.669225, -5.980365], [-77.395498, -6.039377], [-77.132725, -6.302421], [-77.171732, -6.38117], [-77.28666, -6.331023], [-77.436149, -6.605217], [-77.381733, -6.697589], [-77.745606, -6.665158], [-77.758934, -6.964508], [-77.385473, -8.055387], [-77.118324, -8.025244], [-76.906998, -8.170736], [-76.913745, -8.32609], [-77.133844, -8.440021], [-77.049801, -8.553715], [-76.466167, -8.569743], [-76.333468, -8.429474], [-76.230154, -8.796295], [-76.087176, -8.336906], [-75.984963, -8.32215]]] }, "properties": { "NOMBDEP": "SAN MARTIN", "codigo_departamento": "22" } }, { "type": "Feature", "geometry": { "type": "Polygon", "coordinates": [[[-69.64132, -17.28745], [-70.039719, -17.127968], [-70.307611, -16.773047], [-70.441605, -16.841227], [-70.449579, -17.081292], [-70.684221, -17.22498], [-70.9125, -17.68737], [-71.139443, -17.821482], [-70.376711, -18.350928], [-69.960549, -18.262885], [-69.751504, -17.98559], [-69.795988, -17.646242], [-69.468293, -17.50417], [-69.467316, -17.373537], [-69.64132, -17.28745]]] }, "properties": { "NOMBDEP": "TACNA", "codigo_departamento": "23" } }, { "type": "Feature", "geometry": { "type": "Polygon", "coordinates": [[[-80.487332, -4.083129], [-80.140242, -3.912962], [-80.292359, -3.408805], [-80.7536, -3.71817], [-81.041418, -4.087547], [-80.623221, -4.231779], [-80.487332, -4.083129]]] }, "properties": { "NOMBDEP": "TUMBES", "codigo_departamento": "24" } }, { "type": "Feature", "geometry": { "type": "Polygon", "coordinates": [[[-70.613885, -9.916855], [-70.56259, -9.430427], [-71.297436, -9.992178], [-72.180404, -9.999672], [-72.151361, -9.797416], [-72.281326, -9.542299], [-73.200439, -9.411396], [-72.94795, -9.028872], [-73.34414, -8.602744], [-73.330977, -8.475864], [-73.542906, -8.347588], [-73.640298, -8.006514], [-73.767014, -7.910412], [-73.676314, -7.800027], [-74.039966, -7.448155], [-74.501769, -7.266078], [-74.642902, -7.500086], [-74.515718, -7.777173], [-74.627984, -7.939828], [-74.896438, -8.081268], [-74.98226, -7.968986], [-75.142491, -7.978641], [-75.243885, -8.155518], [-75.430096, -8.166598], [-75.44079, -8.436833], [-75.70701, -8.439325], [-75.94575, -8.716139], [-75.794113, -9.188365], [-75.670838, -9.396644], [-75.562445, -9.400172], [-75.282723, -9.309832], [-75.143303, -8.972193], [-74.934164, -8.930225], [-74.846683, -8.661235], [-74.547135, -8.584567], [-74.677103, -9.428324], [-74.496763, -9.59335], [-74.400608, -10.070519], [-74.231661, -10.185052], [-74.276711, -10.374074], [-74.132673, -10.604911], [-74.572995, -10.912602], [-74.373655, -11.056522], [-74.005498, -10.993193], [-73.861304, -11.14553], [-73.7572, -10.735905], [-73.560261, -10.860609], [-73.419749, -11.383938], [-72.989665, -11.198797], [-72.951909, -11.33063], [-72.535086, -11.43508], [-72.239258, -11.345061], [-72.121406, -11.107141], [-72.18209, -11.010242], [-71.357317, -10.951545], [-71.196213, -10.579861], [-70.705111, -10.158681], [-70.613885, -9.916855]]] }, "properties": { "NOMBDEP": "UCAYALI", "codigo_departamento": "25" } }] }

var geojsonLayer = null
var geojsonLayers = [];

var latitud = -8.363386060513093;
var longitud = -75.77929079307746;

// Crear el mapa y establecer la vista
var map = L.map('map').setView([latitud, longitud], 9);

$.ajax({
    url: 'ObtenerDatosJson?iopsp=15',
    type: 'GET',
    success: function (response) {
        // Hacer algo con la respuesta
        let result = JSON.parse(response.result);
        


        agregarPropiedadPorCoincidencia(geojsonFeature, result)

       geojsonLayer= L.geoJSON(geojsonFeature, {
            style: function (feature) {
                return style(feature);
            },
            onEachFeature: function (feature, layer) {
                layer.on({
                    mouseover: highlightFeature,
                    mouseout: resetHighlight,
                    click: function (e) {
                        /*const codigo_departamento = e.sourceTarget.feature.properties.codigo_departamento
                        const nombre = e.sourceTarget.feature.properties.NOMBDEP
                        visualizarPopup(codigo_departamento, nombre);*/
                    }
                });

                layer.bindTooltip(

                    '<h3>' + feature.properties.NOMBDEP + '</h3><br>Cant. Instituciones: ' + feature.properties.cantintituciones + '<br> Cant. Tupa Vigente: ' + feature.properties.canttupavigente +'<br> <b> ' + feature.properties.cant_exp_tupa_vigentes + ' % de avance</b>'
                    ,
                    {
                        permanent: true,
                        direction: 'center',
                        className: 'countryLabel'
                    }

                );

                layer.closeTooltip();

                geojsonLayers.push(layer)

                //layer.bindPopup("dayer");
                //layer.on('mouseover', function(e) {
                //    mostarGrafico(feature.properties.codigo_departamento)
                //});
                //layer.on('mouseout', function(e) {
                //  this.closePopup();
                //});
            }
       }).addTo(map);

        // Llamada a la función cada vez que cambia el zoom
        //map.on('zoomend', adjustTooltipVisibility);


    },
    error: function (xhr, status, error) {
        // Manejar error
        console.error(error);
    }
});

function agregarPropiedadPorCoincidencia(geojson, listaDeObjetos) {
    geojson.features.forEach(function (feature) {
        var category = feature.properties["NOMBDEP"];
        var objetoEncontrado = listaDeObjetos.find(function (objeto) {
            return objeto["NOMBDEP"] === category;
        });

        if (objetoEncontrado) {
            feature.properties.cant_exp_tupa_vigentes = objetoEncontrado.cant;
            feature.properties.cantintituciones = objetoEncontrado.cantintituciones;
            feature.properties.canttupavigente = objetoEncontrado.canttupavigente;
        }
    });
}




// Agregar una capa base (opcional)


function style(feature) {
    return {
        weight: 2,
        opacity: 1,
        color: 'white',
        dashArray: '3',
        fillOpacity: 0.7,
        fillColor: getColor(feature.properties.cant_exp_tupa_vigentes)
    };
}




function getColor(d) {
    return d > 99 ? '#800026' :
        d > 90 ? '#BD0026' :
            d > 60 ? '#E31A1C' :
                d > 40 ? '#FC4E2A' :
                    d > 20 ? '#FD8D3C' :
                        d > 10 ? '#FEB24C' :
                            d > 5 ? '#FED976' : '#FFEDA0';
}

function highlightFeature(e) {
    var layer = e.target;

    layer.setStyle({
        weight: 5,
        color: 'yellow',
        dashArray: '',
        fillOpacity: 0.7
    });

    if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
        layer.bringToFront();
    }
}

function resetHighlight(e) {
    geojsonLayer.resetStyle(e.target);
}


var legend = L.control({ position: 'bottomright' });

legend.onAdd = function (map) {

    var div = L.DomUtil.create('div', 'info legend'),
        grades = [0, 5, 10, 20, 40, 60, 90, 100],
        labels = [];

    // loop through our density intervals and generate a label with a colored square for each interval
    for (var i = 0; i < grades.length; i++) {
        div.innerHTML +=
            '<i style="background:' + getColor(grades[i] + 1) + '"></i> ' +
            grades[i] + (grades[i + 1] ? '&ndash;' + grades[i + 1] + '<br>' : '+');
    }

    return div;
};

legend.addTo(map);




//Valida para mostrar el zoom del nombre de departamentos

// Ajuste el nivel de zoom a partir del cual quieres mostrar el tooltip
var minZoomLevelToShowTooltip = 8;
var maxZoomLevelToShowTooltip = 22;

// Función para ajustar la visibilidad del tooltip
function adjustTooltipVisibility() {
    let zoom = map.getZoom();
    geojsonLayers.forEach(layer => {
        if (zoom >= minZoomLevelToShowTooltip && zoom <= maxZoomLevelToShowTooltip) {
            $('.countryLabel').show()
        } else {
            $('.countryLabel').hide()
        }
    });
}

// Llamada a la función cada vez que cambia el zoom
map.on('zoomend', adjustTooltipVisibility);

//map.setZoom(5);